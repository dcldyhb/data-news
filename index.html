<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>数据镜头下的新职业生存实录</title>

    <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts-wordcloud@2.1.0/dist/echarts-wordcloud.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
      // 自定义throttle函数
      function throttle(func, wait) {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func(...args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      }
    </script>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
      integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucUutcjServCrA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#3B82F6",
              secondary: "#F97316",
              accent: "#10B981",
              "cert-red": "#EF4444",
              "uncert-gray": "#6B7280",
            },
            animation: {
              'fade-in': 'fadeIn 0.6s ease-out',
              'slide-up': 'slideUp 0.8s ease-out',
              'zoom-in': 'zoomIn 0.3s ease-out',
              'pulse-glow': 'pulseGlow 2s ease-in-out infinite',
            },
            keyframes: {
              fadeIn: {
                '0%': { opacity: '0' },
                '100%': { opacity: '1' }
              },
              slideUp: {
                '0%': { opacity: '0', transform: 'translateY(30px)' },
                '100%': { opacity: '1', transform: 'translateY(0)' }
              },
              zoomIn: {
                '0%': { opacity: '0', transform: 'scale(0.9)' },
                '100%': { opacity: '1', transform: 'scale(1)' }
              },
              pulseGlow: {
                '0%, 100%': { opacity: '0.4', transform: 'scale(1)' },
                '50%': { opacity: '0.8', transform: 'scale(1.05)' }
              }
            }
          },
        },
      };
    </script>

    <style type="text/tailwindcss">
      :root {
        --reveal-duration: 0.8s;
        --chart-bg: rgba(31, 41, 55, 0.8);
        --glass-bg: rgba(255, 255, 255, 0.05);
        --glass-border: rgba(255, 255, 255, 0.1);
      }
      html {
        scroll-behavior: smooth;
      }
      
      /* 全屏section样式 */
      section, header {
        scroll-margin-top: 0;
      }
      body {
        background: linear-gradient(135deg, #111827 0%, #1F2937 50%, #111827 100%);
        color: #d1d5db;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
          "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
        overflow-x: hidden;
        overflow-y: auto;
        position: relative;
      }

      /* 性能优化的动画效果 */
      .reveal {
        opacity: 0;
        transform: translateY(30px);
        transition: opacity var(--reveal-duration) cubic-bezier(0.4, 0, 0.2, 1),
          transform var(--reveal-duration) cubic-bezier(0.4, 0, 0.2, 1);
        will-change: opacity, transform;
      }
      .reveal.visible {
        opacity: 1;
        transform: translateY(0);
      }

      /* 优化的玻璃形态效果 */
      .glow-card {
        position: relative;
        overflow: hidden;
        background: linear-gradient(145deg, var(--chart-bg), rgba(17, 24, 39, 0.9));
        border-radius: 1rem;
        border: 1px solid var(--glass-border);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        box-shadow: 
          0 8px 32px rgba(0, 0, 0, 0.3),
          0 1px 4px rgba(255, 255, 255, 0.1) inset;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      .glow-card:hover {
        transform: translateY(-4px);
        box-shadow: 
          0 20px 40px rgba(0, 0, 0, 0.4),
          0 1px 4px rgba(255, 255, 255, 0.15) inset;
      }
      /* 优化弹幕样式 */
      .danmaku {
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: pointer;
        background: rgba(31, 41, 55, 0.85);
        color: white;
        padding: 8px 16px;
        border-radius: 9999px;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        white-space: nowrap;
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        box-shadow: 
          0 4px 12px rgba(0, 0, 0, 0.25),
          0 1px 2px rgba(255, 255, 255, 0.1) inset;
        font-size: 14px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        will-change: transform, box-shadow;
      }
      .danmaku:hover {
        transform: scale(1.05) translateY(-2px);
        box-shadow: 
          0 8px 25px rgba(59, 130, 246, 0.3),
          0 2px 8px rgba(0, 0, 0, 0.4);
        background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
        border-color: rgba(59, 130, 246, 0.5);
        z-index: 50 !important;
      }
      
      /* 优化滚动文本性能 */
      .scroll-text {
        animation: scroll 25s linear infinite;
        position: absolute;
        will-change: transform;
        left: 100vw;
        contain: layout style paint;
      }
      .scroll-text:hover {
        animation-play-state: paused;
      }
      
      @keyframes scroll {
        from { transform: translate3d(0, 0, 0); }
        to { transform: translate3d(calc(-100vw - 100%), 0, 0); }
      }
      /* 点赞样式优化 */
      .danmaku .likes {
        color: #fcd34d;
        font-size: 12px;
        font-weight: 500;
        display: inline-flex;
        align-items: center;
        gap: 4px;
        opacity: 0.9;
      }

      /* ECharts 工具提示样式优化 */
      .echarts-tooltip {
        background: rgba(17, 24, 39, 0.95) !important;
        border: 1px solid rgba(255, 255, 255, 0.1) !important;
        color: #d1d5db !important;
        border-radius: 8px !important;
        backdrop-filter: blur(10px) !important;
        -webkit-backdrop-filter: blur(10px) !important;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5) !important;
      }
      .echarts-tooltip-name {
        color: #9ca3af !important;
      }
      .echarts-tooltip-value {
        font-weight: bold !important;
      }

      /* 文本样式优化 - 两端对齐和首行缩进 */
      p {
        text-align: justify !important;
        text-indent: 2em;
        line-height: 1.8;
        margin-bottom: 1.2em;
        color: rgba(209, 213, 219, 0.9);
      }

      /* 段落文本统一样式 */
      .text-content, 
      .fullscreen-text,
      div.text-center.max-w-3xl,
      div.text-center.max-w-4xl,
      div.text-center.max-w-5xl,
      .section-content p,
      .leading-relaxed {
        text-align: justify !important;
        text-indent: 2em !important;
        line-height: 1.8;
        color: rgba(209, 213, 219, 0.9);
      }

      /* 特定不需要缩进的元素 */
      h1, h2, h3, h4, h5, h6,
      .danmaku, input, button, .subtitle,
      footer p, 
      .image-caption,
      nav p,
      .text-sm,
      .text-xs,
      .nav-item,
      .modal-close,
      .chart-title,
      .debug-info {
        text-align: center !important;
        text-indent: 0 !important;
      }

      /* 确保导航菜单文本不受影响 */
      nav, nav *, .nav-indicator, .nav-progress {
        text-align: left !important;
        text-indent: 0 !important;
      }

      /* 强制正文内容应用两端对齐和首行缩进 */
      .lg\:col-span-3 p,
      .max-w-md p,
      .max-w-lg p,
      .max-w-xl p,
      .max-w-2xl p,
      .max-w-3xl p,
      .max-w-4xl p,
      .max-w-5xl p,
      .max-w-6xl p,
      .text-2xl.text-gray-300 p {
        text-align: justify !important;
        text-indent: 2em !important;
        line-height: 1.8 !important;
      }

      /* 内容区域样式优化 */
      .section-content {
        max-width: 100%;
        margin: 0 auto;
      }

      .chart-container {
        background: linear-gradient(145deg, var(--chart-bg), rgba(17, 24, 39, 0.9));
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        position: relative;
        overflow: hidden;
        max-height: 60vh;
      }

      .chart-container::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.1) 0%,
          transparent 50%,
          rgba(255, 255, 255, 0.05) 100%
        );
        pointer-events: none;
      }

      .text-content {
        background: linear-gradient(145deg, var(--glass-bg), rgba(31, 41, 55, 0.2));
        border: 1px solid var(--glass-border);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        padding: 2.5rem;
        border-radius: 1rem;
        margin-bottom: 2rem;
        position: relative;
        overflow: hidden;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        font-size: 1.125rem;
        line-height: 1.8;
        max-width: 80%;
        margin-left: auto;
        margin-right: auto;
      }

      .text-content::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          120deg,
          rgba(255, 255, 255, 0.05) 0%,
          transparent 50%,
          rgba(255, 255, 255, 0.02) 100%
        );
        pointer-events: none;
      }

      .text-content:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
      }

      /* 全屏section样式 */
      .content-wrapper {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 2rem;
        height: auto;
        min-height: 40vh;
      }

      /* 适配全屏图表 */
      .chart-container.fullscreen-chart {
        width: 90%;
        max-width: 1200px;
        height: 50vh;
        min-height: 400px;
      }

      /* 全屏文本内容 */
      .text-content.fullscreen-text {
        max-width: 70%;
        font-size: 1.25rem;
        line-height: 2;
        text-align: center;
      }

      .lg\\:col-span-3.text-xl.text-gray-300 {
        padding: 0 2rem;
      }

      .lg\\:col-span-3.text-xl.text-gray-300 p {
        max-width: 18rem;
        margin: 0 auto;
        line-height: 1.8;
      }

      @media (max-width: 768px) {
        .grid.lg\\:grid-cols-5 {
          grid-template-columns: 1fr !important;
          gap: 2rem !important;
        }

        .lg\\:col-span-3,
        .lg\\:col-span-2 {
          grid-column: span 1 !important;
        }

        /* 移动端全屏优化 */
        .fullscreen-chart {
          width: 95% !important;
          height: 40vh !important;
        }

        .fullscreen-text {
          max-width: 95% !important;
          font-size: 1rem !important;
          padding: 1.5rem !important;
        }

        h2 {
          font-size: 2.5rem !important;
        }

        .subtitle {
          font-size: 1.125rem !important;
        }
      }

      /* 图片放大模态框优化 */
      .image-modal {
        display: none;
        position: fixed;
        z-index: 9999;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .image-modal.show {
        display: flex !important;
        align-items: center;
        justify-content: center;
        animation: fadeIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .modal-content {
        max-width: 90vw;
        max-height: 90vh;
        border-radius: 1rem;
        box-shadow: 
          0 25px 50px rgba(0, 0, 0, 0.8),
          0 0 0 1px rgba(255, 255, 255, 0.1);
        animation: zoomIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        object-fit: contain;
      }

      .modal-close {
        position: absolute;
        top: 20px;
        right: 30px;
        color: rgba(255, 255, 255, 0.8);
        font-size: 36px;
        font-weight: bold;
        cursor: pointer;
        z-index: 10000;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }

      .modal-close:hover {
        color: #3b82f6;
        background: rgba(59, 130, 246, 0.1);
        transform: scale(1.1);
      }

      .clickable-image {
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border-radius: 0.75rem;
        overflow: hidden;
      }

      .clickable-image:hover {
        transform: scale(1.02) translateY(-2px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
      }

      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }

      @keyframes zoomIn {
        from { transform: scale(0.7); opacity: 0; }
        to { transform: scale(1); opacity: 1; }
      }

      /* 图表放大模态框 */
      .chart-modal {
        display: none;
        position: fixed;
        z-index: 9999;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .chart-modal.show {
        display: flex !important;
        align-items: center;
        justify-content: center;
        animation: fadeIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .chart-modal-content {
        width: 95vw;
        height: 90vh;
        background: rgba(17, 24, 39, 0.95);
        border-radius: 1rem;
        box-shadow: 
          0 25px 50px rgba(0, 0, 0, 0.8),
          0 0 0 1px rgba(255, 255, 255, 0.1);
        animation: zoomIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        padding: 20px;
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
      }

      .chart-modal-close {
        position: absolute;
        top: 10px;
        right: 15px;
        color: rgba(255, 255, 255, 0.8);
        font-size: 36px;
        font-weight: bold;
        cursor: pointer;
        z-index: 10001;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }

      .chart-modal-close:hover {
        color: #3b82f6;
        background: rgba(59, 130, 246, 0.1);
        transform: scale(1.1);
      }

      .chart-container {
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
      }

      .chart-container:hover {
        transform: scale(1.02);
        box-shadow: 0 20px 40px rgba(59, 130, 246, 0.2);
      }

      .chart-container::after {
        content: "🔍";
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 8px 12px;
        border-radius: 50%;
        font-size: 14px;
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: 10;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }

      .chart-container:hover::after {
        opacity: 1;
      }

      /* 导航样式增强 */
      .nav-section {
        position: relative;
        overflow: hidden;
      }
      
      .nav-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transition: left 0.5s;
      }
      
      .nav-section:hover::before {
        left: 100%;
      }
      
      .nav-active {
        background: rgba(59, 130, 246, 0.2) !important;
        border-left: 3px solid #3b82f6;
        color: #60a5fa !important;
      }
      
      .nav-indicator {
        position: fixed;
        top: 50%;
        right: 2px;
        transform: translateY(-50%);
        width: 2px;
        height: 200px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 1px;
        z-index: 40;
      }
      
      .nav-progress {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        background: linear-gradient(180deg, #3b82f6, #8b5cf6, #ec4899);
        border-radius: 1px;
        transition: height 0.3s ease;
      }
    </style>
  </head>
  <body class="bg-gray-900 text-gray-300">
    <!-- 完整导航菜单 -->
    <nav class="fixed top-4 right-4 z-50 bg-black/80 backdrop-blur-md rounded-xl p-4 text-sm max-w-xs shadow-2xl border border-gray-700/50">
      <div class="text-cyan-400 font-bold mb-3 text-center border-b border-gray-700 pb-2">📑 目录导航</div>
      <div class="space-y-1">
        <a href="#header" class="nav-section block text-blue-400 hover:text-blue-300 transition-all hover:bg-blue-500/10 px-3 py-2 rounded-lg" data-section="header">
          <span class="text-gray-400">📍</span> 标题页
        </a>
        <a href="#status-intro" class="nav-section block text-emerald-400 hover:text-emerald-300 transition-all hover:bg-emerald-500/10 px-3 py-2 rounded-lg" data-section="status-intro">
          <span class="text-gray-400">01</span> 行业现状
        </a>
        <a href="#drivers" class="nav-section block text-purple-400 hover:text-purple-300 transition-all hover:bg-purple-500/10 px-3 py-2 rounded-lg" data-section="drivers">
          <span class="text-gray-400">02</span> 驱动密码
        </a>
        <a href="#rectification" class="nav-section block text-yellow-400 hover:text-yellow-300 transition-all hover:bg-yellow-500/10 px-3 py-2 rounded-lg" data-section="rectification">
          <span class="text-gray-400">03</span> "正名"时间
        </a>
        <a href="#predicament" class="nav-section block text-red-400 hover:text-red-300 transition-all hover:bg-red-500/10 px-3 py-2 rounded-lg" data-section="predicament">
          <span class="text-gray-400">04</span> 行业困境
        </a>
        <a href="#reconstruction" class="nav-section block text-indigo-400 hover:text-indigo-300 transition-all hover:bg-indigo-500/10 px-3 py-2 rounded-lg" data-section="reconstruction">
          <span class="text-gray-400">05</span> 价值重构
        </a>
        <a href="#conclusion" class="nav-section block text-pink-400 hover:text-pink-300 transition-all hover:bg-pink-500/10 px-3 py-2 rounded-lg" data-section="conclusion">
          <span class="text-gray-400">🏁</span> 结尾
        </a>
      </div>
      <div class="mt-4 pt-3 border-t border-gray-700">
        <button onclick="scrollToTop()" class="block w-full text-green-400 hover:text-green-300 transition-all hover:bg-green-500/10 px-3 py-2 rounded-lg cursor-pointer text-center">
          ⬆️ 回到顶部
        </button>
      </div>
    </nav>

    <!-- 页面进度指示器 -->
    <div class="nav-indicator">
      <div class="nav-progress" id="navProgress"></div>
    </div>

    <!-- 图片放大模态框 -->
    <div id="imageModal" class="image-modal" onclick="closeImageModal()">
      <span class="modal-close" onclick="closeImageModal()">&times;</span>
      <img id="modalImage" class="modal-content" alt="" />
    </div>

    <!-- 图表放大模态框 -->
    <div id="chartModal" class="chart-modal" onclick="closeChartModal()">
      <div class="chart-modal-content" onclick="event.stopPropagation()">
        <span class="chart-modal-close" onclick="closeChartModal()">&times;</span>
        <div id="modalChart" style="width: 100%; height: calc(100% - 40px);"></div>
      </div>
    </div>

    <header
      id="header"
      class="min-h-screen flex flex-col items-center justify-center text-center p-8 relative overflow-hidden"
    >
      <div
        class="absolute inset-0 bg-gradient-to-br from-blue-900/50 via-gray-900 to-gray-900 z-0"
      ></div>
      <div
        class="absolute -top-1/4 -left-1/4 w-1/2 h-1/2 bg-blue-500/20 rounded-full filter blur-3xl animate-pulse"
      ></div>
      <div
        class="absolute -bottom-1/4 -right-1/4 w-1/2 h-1/2 bg-orange-500/20 rounded-full filter blur-3xl animate-pulse delay-1000"
      ></div>

      <div class="relative z-20 w-full max-w-7xl">
        <h1
          class="text-4xl md:text-8xl font-bold text-white mb-8 tracking-tight leading-tight text-center"
        >
          <span class="block md:inline">数据镜头下的</span
          ><br class="md:hidden" />
          <span
            class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-600 animate-pulse"
          >
            新职业生存实录
          </span>
        </h1>

        <div
          class="max-w-7xl mx-auto mb-12 mt-16 grid lg:grid-cols-5 gap-8 items-center"
        >
          <div
            class="lg:col-span-3 lg:order-2 text-2xl text-gray-300 space-y-6 flex items-center justify-center text-content"
          >
            <p class="leading-relaxed max-w-md">
              自4月19日起，每周六和重大节假日“魅力重庆”无人机灯光秀在重庆两江四岸核心区常态化展演，背后是无人机飞行工程师陆子祥团队操作。随着低空经济的蓬勃发展，无人机飞行工程师作为新兴职业逐渐进入大家视野。
            </p>
          </div>
          <div class="lg:col-span-2 lg:order-1 flex justify-center">
            <div class="relative group">
              <img
                src="figures/chongqing-drone-show-engineer-preparation.jpg"
                alt="重庆无人机灯光秀工程师准备工作"
                class="w-full max-w-xs h-auto rounded-xl shadow-2xl border border-gray-600/50 group-hover:shadow-cyan-500/25 transition-all duration-300 group-hover:scale-105 group-hover:border-cyan-500/50 clickable-image"
                onclick="openImageModal(this)"
              />
              <div
                class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent rounded-xl pointer-events-none"
              ></div>
              <div class="w-full flex justify-center mt-4">
                <p
                  class="text-sm text-gray-400 text-center opacity-75 bg-gray-800/30 px-3 py-1 rounded-full backdrop-blur-sm"
                >
                  <i class="fa fa-camera mr-2"></i>来源：微博
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- 新职业发展趋势图表 -->
        <div class="w-full max-w-7xl mx-auto mb-16">
          <div class="text-center mb-8 text-content">
            <h3 class="text-2xl md:text-3xl font-bold text-white mb-4">
              新职业发布趋势分析
            </h3>
            <p class="text-gray-400 text-xl max-w-3xl mx-auto leading-relaxed">
              自2019年建立新职业信息发布制度以来，人社部已累计发布了7批共110个新兴职业，主要分布在人工智能与数字经济、康养服务、低碳环保与工业技术等领域。新兴职业逐渐兴起，产业结构、地域结构、职业性质、人才结构维度均发生变化，就业结构进入了“动态重组期”。权威数据将作为追光灯，深入分析新兴职业的发展现状、背后动因及面临的问题，展现这场职业变革的壮阔图景。
            </p>
          </div>
          <div
            id="header-chart"
            class="w-full h-96 glow-card p-6 chart-container"
          ></div>
        </div>
      </div>
    </header>

    <main id="main-content"></main>

    <footer class="text-center py-10 bg-gray-900 border-t border-gray-800">
      <p class="text-gray-500">&copy; 2025 新职业观察报告.</p>
    </footer>

    <template id="section-template">
      <section class="min-h-screen flex flex-col items-center justify-center text-center p-8 relative overflow-hidden reveal">
        <div
          class="absolute inset-0 bg-gradient-to-br from-blue-900/50 via-gray-900 to-gray-900 z-0"
        ></div>
        <div
          class="absolute -top-1/4 -left-1/4 w-1/2 h-1/2 bg-blue-500/20 rounded-full filter blur-3xl animate-pulse"
        ></div>
        <div
          class="absolute -bottom-1/4 -right-1/4 w-1/2 h-1/2 bg-orange-500/20 rounded-full filter blur-3xl animate-pulse delay-1000"
        ></div>
        
        <div class="relative z-20 w-full max-w-7xl">
          <h2
            class="text-4xl md:text-8xl font-bold text-white mb-8 tracking-tight leading-tight text-center"
          ></h2>
          <div
            class="subtitle text-center text-gray-300 mb-16 text-2xl max-w-4xl mx-auto leading-relaxed text-content"
          ></div>
          <div class="content-wrapper"></div>
        </div>
      </section>
    </template>

    <template id="intro-template">
      <section
        class="min-h-screen flex flex-col items-center justify-center text-center p-8 relative overflow-hidden reveal"
      >
        <div
          class="absolute inset-0 bg-gradient-to-br from-blue-900/50 via-gray-900 to-gray-900 z-0"
        ></div>
        <div
          class="absolute -top-1/4 -left-1/4 w-1/2 h-1/2 bg-blue-500/20 rounded-full filter blur-3xl animate-pulse"
        ></div>
        <div
          class="absolute -bottom-1/4 -right-1/4 w-1/2 h-1/2 bg-orange-500/20 rounded-full filter blur-3xl animate-pulse delay-1000"
        ></div>
        <div
          id="danmaku-container"
          class="absolute inset-0 z-10"
          aria-hidden="true"
        ></div>
        <div class="relative z-20 w-full max-w-7xl">
          <h2
            class="text-4xl md:text-8xl font-bold text-white mb-8 tracking-tight leading-tight text-center"
          ></h2>
        </div>
      </section>
    </template>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const contentTemplates = {
          status: `<div class="space-y-20"><div class="text-center max-w-5xl mx-auto text-content fullscreen-text">在人社部2023年修订的《新职业评审工作规则》中，职业认证需经申报、评审、公示等五步流程，平均耗时18个月。以“老年数字服务师”为例，该职业从民间称呼到官方认证，经历了从“老年数字辅导员”“银发生活规划师”到统一职业标准的转变。这一过程，既体现对职业规范性的高度重视，也反映新兴职业认证的复杂性与严谨性。</div><div class="lifecycle-chart w-full h-[30vh] glow-card p-6 chart-container fullscreen-chart"></div><div class="text-center max-w-5xl mx-auto text-content fullscreen-text">与此同时，新兴职业在不同地域呈现出不同发展态势。在京津冀、长三角与珠三角，猎头们为“人工智能训练师”“碳排放管理员”开出25—40万元年薪，外加期权与落户指标；同一条招聘启事，24小时内就能收到上千份简历。而在西部与东北，同样的岗位招聘量不足东部的五分之一。企业HR只能把JD改成“可远程、可兼职、可培训上岗”，却依旧无人问津。这道裂缝，一面是产业密度——东部拥有更完整的上下游配套，让新职业能够“即插即用”；另一面是政策脉冲——地方补贴、人才公寓、税收优惠像磁铁一样把年轻人吸走。新职业在不同地域呈现出截然不同的生命体征。</div>`,
          drivers: `
            <div class="sankey-chart w-full h-[50vh] glow-card p-6 chart-container fullscreen-chart"></div>
          `,
          rectification: `
            <div class="text-center max-w-5xl mx-auto text-content fullscreen-text">
              职业名称的"正名"过程，藏着行业成熟的密码。2022年"银发经济"相关岗位中，38%的招聘信息使用"老年数字辅导员""银发生活规划师"等民间称呼，直到2024 年 "老年数字服务师"被纳入新职业目录，才形成统一的职业标准。
            </div>
            <div class="rectification-word-clouds w-full h-[40vh] mt-8 chart-container fullscreen-chart"></div>
          `,
          predicament: `
            <div class="text-center max-w-5xl mx-auto text-content fullscreen-text">
              繁荣背后，新兴职业的权益保障仍存短板。数据显示，未认证职业从业者中，68%未签订规范劳动合同，45%无法享受带薪休假。
            </div>
            <div class="rights-barchart w-full h-[40vh] mt-8 glow-card p-6 chart-container fullscreen-chart"></div>
          `,
          reconstruction: `
            <div class="text-center max-w-6xl mx-auto space-y-6 text-content fullscreen-text">
              <p>宋龙杰从一线收派件到获评"济南市技术能手"，再到成为首批E类高层次人才，他的逆袭成为数万从业者的缩影。</p>
              <p>当代年轻人渴望摆脱传统职场的束缚、追求更加灵活的工作方式的态度。他们希望能够在自己的节奏下工作，充分发挥创造力，同时享受生活的平衡。</p>
            </div>
            <div class="factors-piechart w-full h-[40vh] mt-8 chart-container fullscreen-chart"></div>
          `,
          conclusion: `
            <div class="text-center max-w-6xl mx-auto space-y-6 text-content fullscreen-text">
              <p>从电影《她》走出的人工智能数字人训练师，从《聊斋志异》走出的服务犬驯养师……新兴职业的生长史，本质上是个体价值与时代需求的"动态应答"。</p>
              <p>从技术驱动到政策规范，从权益保障到价值重构，每一组数据的波动，都在书写着就业市场的新规则——而那些尚未被命名的职业，或许正藏着未来社会的模样。</p>
            </div>
            <div class="future-map w-full h-[35vh] mt-8 glow-card p-6 chart-container fullscreen-chart relative"></div>
            <div class="mt-8 text-center text-content fullscreen-text">
              <p class="text-2xl mb-6 text-gray-300">你认为下一个被认证的职业会是？</p>
              <div class="flex justify-center gap-4 max-w-lg mx-auto">
                <input type="text" placeholder="输入你的想法..." class="bg-gray-700/50 border border-gray-600 rounded-xl px-6 py-4 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent flex-1 backdrop-blur-sm text-lg">
                <button class="bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-bold py-4 px-8 rounded-xl transition-all hover:scale-105 hover:shadow-lg hover:shadow-cyan-500/25 text-lg">提交</button>
              </div>
            </div>
          `,
        };
        const sections = [
          {
            id: "status-intro",
            title: "01. 行业现状",
            isIntro: true,
            setup: setupStatusIntro,
          },
          { id: "status", title: "", setup: setupStatusCharts },
          {
            id: "drivers",
            title: "02. 驱动密码",
            subtitle:
              "新兴职业的爆发并非偶然，而是技术突破、市场需求与政策引导共同作用的结果。",
            setup: setupSankeyChart,
          },
          {
            id: "rectification",
            title: '03. "正名"时间',
            setup: setupRectificationCharts,
          },
          { id: "predicament", title: "04. 行业困境", setup: setupRightsChart },
          {
            id: "reconstruction",
            title: "05. 价值重构",
            setup: setupReconstructionChart,
          },
          { id: "conclusion", title: "结尾", setup: setupConclusionChart },
        ];
        const echartsTooltipOption = {
          backgroundColor: "rgba(17, 24, 39, 0.95)",
          borderColor: "rgba(255, 255, 255, 0.1)",
          borderWidth: 1,
          borderRadius: 8,
          textStyle: { 
            color: "#D1D5DB",
            fontSize: 12,
            lineHeight: 1.4
          },
          extraCssText: `
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
          `,
          className: "echarts-tooltip",
        };

        function initPage() {
          initHeaderChart();

          const mainContent = document.getElementById("main-content");
          const sectionTemplate = document.getElementById("section-template");
          const introTemplate = document.getElementById("intro-template");
          if (!mainContent || !sectionTemplate || !introTemplate) {
            console.error("Essential elements not found!");
            return;
          }

          sections.forEach((data) => {
            let sectionClone;
            if (data.isIntro) {
              sectionClone = introTemplate.content.cloneNode(true);
              const sectionEl = sectionClone.querySelector("section");
              sectionEl.id = data.id;
              sectionClone.querySelector("h2").innerHTML = data.title;
            } else {
              sectionClone = sectionTemplate.content.cloneNode(true);
              const sectionEl = sectionClone.querySelector("section");
              sectionEl.id = data.id;
              sectionClone.querySelector("h2").innerHTML = data.title;
              const subtitleEl = sectionClone.querySelector(".subtitle");
              if (data.subtitle) {
                subtitleEl.innerHTML = data.subtitle;
              } else {
                subtitleEl.remove();
              }
              if (contentTemplates[data.id]) {
                sectionClone.querySelector(".content-wrapper").innerHTML =
                  contentTemplates[data.id];
              }
            }

            mainContent.appendChild(sectionClone);
            if (data.setup) {
              try {
                const sectionEl = mainContent.querySelector(`#${data.id}`);
                data.setup(sectionEl);
              } catch (e) {
                console.error(`Error setting up section "${data.id}":`, e);
              }
            }
          });

          setupScrollAnimations();
        }

        function setupScrollAnimations() {
          const observer = new IntersectionObserver(
            (entries) => {
              entries.forEach((entry) => {
                if (entry.isIntersecting) {
                  // 添加小延迟创建更流畅的动画效果
                  setTimeout(() => {
                    entry.target.classList.add("visible");
                  }, entry.target.dataset.delay || 0);
                  observer.unobserve(entry.target);
                }
              });
            },
            { 
              rootMargin: "0px 0px -100px 0px",
              threshold: 0.1
            }
          );

          document
            .querySelectorAll(".reveal")
            .forEach((el, index) => {
              // 为每个元素添加递增的延迟
              el.dataset.delay = index * 100;
              observer.observe(el);
            });
        }

        function setupDanmaku() {
          const container = document.getElementById("danmaku-container");
          if (!container) return;
          
          const danmakuItems = [
            {
              text: '说的太好了，未来的职场，只有"金手艺"，没有"铁饭碗"！！！',
              likes: "170",
            },
            {
              text: "数据分析师，学费基本2万以上，刚出来工资基本税前8000左右",
              likes: "2872",
            },
            { text: "新职业+新工种+老员工+老技术=办新证", likes: "2182" },
            { text: "取消劳务派遣", likes: "5231" },
            {
              text: "养老服务师绝对吃香，现在的中国己经进入人口老龄化了",
              likes: "273",
            },
            { text: "这些行业该怎么入行呢", likes: "8769" },
            { text: "新兴职业的出现也给了年轻人更多的选择机会", likes: "1086" },
            {
              text: "传统行业被男的占据太久了，新兴行业女性可以直接参与",
              likes: "4549",
            },
          ];

          // 优化弹幕创建，减少重复代码
          const createDanmaku = (item, index) => {
            const wrapper = document.createElement("div");
            wrapper.className = "scroll-text";
            wrapper.style.top = `${8 + (index % 8) * 11}%`;
            wrapper.style.animationDuration = `${12 + Math.random() * 8}s`;
            wrapper.style.animationDelay = `${index * 1.5 + Math.random() * 2}s`;
            
            const el = document.createElement("div");
            el.className = "danmaku";
            el.innerHTML = `
              <span>${item.text}</span>
              <span class="likes" style="margin-left: 8px; display: inline-flex; align-items: center; gap: 4px;">
                <span style="font-size: 12px;">👍</span>
                <span>${item.likes}</span>
              </span>
            `;

            // 使用事件委托优化性能
            const handleMouseEnter = () => wrapper.style.animationPlayState = "paused";
            const handleMouseLeave = () => wrapper.style.animationPlayState = "running";
            
            el.addEventListener("mouseenter", handleMouseEnter, { passive: true });
            el.addEventListener("mouseleave", handleMouseLeave, { passive: true });

            wrapper.appendChild(el);
            return wrapper;
          };

          // 使用 DocumentFragment 优化 DOM 操作
          const fragment = document.createDocumentFragment();
          danmakuItems.forEach((item, i) => {
            fragment.appendChild(createDanmaku(item, i));
          });
          container.appendChild(fragment);
        }

        function initHeaderChart() {
          // 使用 requestAnimationFrame 优化图表初始化时机
          requestAnimationFrame(() => {
            const chartElement = document.getElementById("header-chart");
            if (!chartElement) {
              console.error("Header chart element not found");
              return;
            }

            // 检查元素是否已经初始化过
            if (chartElement.hasAttribute('data-chart-initialized')) return;
            chartElement.setAttribute('data-chart-initialized', 'true');
            
            const headerChart = echarts.init(chartElement, "dark");
            // 存储为全局变量以供模态框使用
            window.headerChart = headerChart;

            const years = ["2019年", "2020年", "2021年", "2022年", "2024年", "2025年"];
            const jobCounts = [13, 16, 18, 18, 19, 17];
            const growthRates = [0, 23.08, 12.5, 0, 5.56, -10.53];

            const option = {
              title: {
                text: "新兴职业发布趋势",
                left: "center",
                textStyle: {
                  color: "#fff",
                  fontSize: 20,
                  fontWeight: "bold",
                },
              },
              tooltip: {
                trigger: "axis",
                axisPointer: {
                  type: "cross",
                  crossStyle: { color: "#999" },
                },
                ...echartsTooltipOption,
                formatter: function (params) {
                  let result = `<div style="font-weight: bold; margin-bottom: 5px;">${params[0].axisValue}</div>`;
                  params.forEach(param => {
                    const marker = `<span style="display: inline-block; width: 10px; height: 10px; border-radius: 50%; background: ${param.color}; margin-right: 5px;"></span>`;
                    const unit = param.seriesName.includes('数量') ? '个' : '%';
                    result += `${marker}${param.seriesName}: ${param.value}${unit}<br/>`;
                  });
                  return result;
                }
              },
              legend: {
                data: ["新增职业数量", "增长速度"],
                top: "12%",
                textStyle: { color: "#fff", fontSize: 12 },
              },
              xAxis: [
                {
                  type: "category",
                  data: years,
                  axisPointer: { type: "shadow" },
                  axisLabel: { color: "#9CA3AF", fontSize: 11 },
                  axisLine: { lineStyle: { color: "#4B5563" } },
                },
              ],
              yAxis: [
                {
                  type: "value",
                  name: "职业数量",
                  min: 0,
                  max: 25,
                  interval: 5,
                  axisLabel: {
                    formatter: "{value} 个",
                    color: "#9CA3AF",
                  },
                  nameTextStyle: { color: "#9CA3AF" },
                  axisLine: { lineStyle: { color: "#4B5563" } },
                  splitLine: { lineStyle: { color: "#374151", type: "dashed" } },
                },
                {
                  type: "value",
                  name: "增长速度",
                  min: -20,
                  max: 30,
                  interval: 10,
                  axisLabel: {
                    formatter: "{value}%",
                    color: "#9CA3AF",
                  },
                  nameTextStyle: { color: "#9CA3AF" },
                  axisLine: { lineStyle: { color: "#4B5563" } },
                  splitLine: { show: false },
                },
              ],
              series: [
                {
                  name: "新增职业数量",
                  type: "bar",
                  data: jobCounts,
                  itemStyle: {
                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                      { offset: 0, color: "#60A5FA" },
                      { offset: 0.5, color: "#3B82F6" },
                      { offset: 1, color: "#1E40AF" },
                    ]),
                    borderRadius: [4, 4, 0, 0],
                  },
                  emphasis: {
                    itemStyle: {
                      color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                        { offset: 0, color: "#93C5FD" },
                        { offset: 1, color: "#3B82F6" },
                      ])
                    }
                  },
                  label: {
                    show: true,
                    position: "top",
                    color: "#fff",
                    fontSize: 11,
                    fontWeight: "bold",
                  },
                },
                {
                  name: "增长速度",
                  type: "line",
                  yAxisIndex: 1,
                  data: growthRates,
                  itemStyle: { color: "#F97316" },
                  lineStyle: {
                    color: "#F97316",
                    width: 3,
                    shadowColor: "rgba(249, 115, 22, 0.3)",
                    shadowBlur: 8,
                  },
                  symbol: "circle",
                  symbolSize: 8,
                  emphasis: {
                    symbolSize: 12,
                    lineStyle: { width: 4 }
                  },
                  label: {
                    show: true,
                    position: "top",
                    formatter: "{c}%",
                    color: "#F97316",
                    fontSize: 10,
                    fontWeight: "bold",
                  },
                },
              ],
              grid: {
                left: "10%",
                right: "10%",
                bottom: "15%",
                top: "30%",
              },
              animationDuration: 1500,
              animationEasing: 'cubicOut',
            };

            headerChart.setOption(option);

            // 优化窗口大小变化处理
            const resizeHandler = throttle(() => {
              headerChart.resize();
            }, 300);
            
            window.addEventListener("resize", resizeHandler);
            
            // 存储图表实例以便清理
            chartElement._chartInstance = headerChart;
            chartElement._resizeHandler = resizeHandler;
          });
        }

        function setupStatusIntro(section) {
          const container = section.querySelector("#danmaku-container");
          if (!container) return;
          const danmakuItems = [
            {
              text: '说的太好了，未来的职场，只有"金手艺"，没有"铁饭碗"！！！',
              likes: "170",
            },
            {
              text: "数据分析师，学费基本2万以上，刚出来工资基本税前8000左右",
              likes: "2872",
            },
            { text: "新职业+新工种+老员工+老技术=办新证", likes: "2182" },
            { text: "取消劳务派遣", likes: "5231" },
            {
              text: "养老服务师绝对吃香，现在的中国己经进入人口老龄化了",
              likes: "273",
            },
            { text: "这些行业该怎么入行呢", likes: "8769" },
            { text: "新兴职业的出现也给了年轻人更多的选择机会", likes: "1086" },
            {
              text: "传统行业被男的占据太久了，新兴行业女性可以直接参与",
              likes: "4549",
            },
          ];
          danmakuItems.forEach((item, i) => {
            const wrapper = document.createElement("div");
            wrapper.className = "scroll-text";
            // 改进弹幕垂直分布，确保更均匀覆盖屏幕
            wrapper.style.top = `${5 + (i % 8) * 11}%`;
            // 调整动画持续时间和延迟，让弹幕更连续，速度更快
            wrapper.style.animationDuration = `${8 + Math.random() * 7}s`;
            wrapper.style.animationDelay = `${i * 2 + Math.random() * 3}s`;
            const el = document.createElement("div");
            el.className = "danmaku";
            el.innerHTML = `
              <span>${item.text}</span>
              <span class="likes" style="margin-left: 8px; display: inline-flex; align-items: center; gap: 4px;">
                <span style="font-size: 12px;">👍</span>
                <span>${item.likes}</span>
              </span>
            `;

            // 添加鼠标悬停暂停功能
            el.addEventListener("mouseenter", () => {
              wrapper.style.animationPlayState = "paused";
            });

            el.addEventListener("mouseleave", () => {
              wrapper.style.animationPlayState = "running";
            });

            wrapper.appendChild(el);
            container.appendChild(wrapper);
          });
        }

        function setupStatusCharts(section) {
          // 添加延迟确保DOM完全渲染
          setTimeout(() => {
            const lifecycleElement = section.querySelector(".lifecycle-chart");
            if (!lifecycleElement) {
              console.error("Lifecycle chart element not found");
              return;
            }
            const lifecycleChart = echarts.init(lifecycleElement, "dark");
            // 存储为全局变量以供模态框使用
            window.lifecycleChart = lifecycleChart;
            lifecycleChart.setOption({
              tooltip: { ...echartsTooltipOption },
              series: [
                {
                  type: "graph",
                  layout: "none",
                  symbolSize: [100, 60],
                  roam: false,
                  label: {
                    show: true,
                    color: "#fff",
                    fontSize: 11,
                    fontWeight: "bold",
                    formatter: function (params) {
                      return params.name;
                    },
                  },
                  tooltip: {
                    show: true,
                    backgroundColor: "rgba(0,0,0,0.8)",
                    borderColor: "#4B5563",
                    borderWidth: 1,
                    textStyle: {
                      color: "#fff",
                      fontSize: 12,
                    },
                    formatter: function (params) {
                      const descriptions = {
                        预研阶段:
                          "<b>预研阶段</b><br/>📋 前期研究准备<br/>• 技术可行性分析<br/>• 市场需求调研<br/>• 风险评估报告",
                        正式申报:
                          "<b>正式申报</b><br/>📝 提交申报材料<br/>• 完整申报文件<br/>• 标准申报表格<br/>• 相关证明材料",
                        形式审查:
                          "<b>形式审查</b><br/>🔍 材料完整性检查<br/>• 检查材料完整性<br/>• 验证格式规范性<br/>• 确认申报资质",
                        限期补正:
                          "<b>限期补正</b><br/>⚠️ 材料补充完善<br/>• 补正材料不足<br/>• 按要求完善文件<br/>• 重新提交审查",
                        专家评审:
                          "<b>专家评审</b><br/>👥 行业专家评议<br/>• 组织行业专家评议<br/>• 技术方案论证<br/>• 出具评审意见",
                        技术评审:
                          "<b>技术评审</b><br/>🔬 技术深度评估<br/>• 技术指标验证<br/>• 安全性评估<br/>• 标准符合性检查",
                        终止流程:
                          "<b>终止流程</b><br/>🛑 审批流程结束<br/>• 技术风险过高<br/>• 不符合国家政策<br/>• 存在安全隐患",
                        公示征求意见:
                          "<b>公示征求意见</b><br/>📢 社会公众监督<br/>• 公开征求意见<br/>• 收集社会反馈<br/>• 处理意见建议",
                        部际联席会议:
                          "<b>部际联席会议</b><br/>🏛️ 跨部门协调<br/>• 相关部委联合审议<br/>• 政策协调统一<br/>• 形成审议意见",
                        国务院审批:
                          "<b>国务院审批</b><br/>🏆 最高级别审批<br/>• 最高级别审批<br/>• 政策合规性确认<br/>• 正式批准文件",
                        发布实施:
                          "<b>发布实施</b><br/>✅ 正式生效执行<br/>• 正式对外发布<br/>• 制定实施细则<br/>• 开始执行监管",
                      };
                      return descriptions[params.name] || params.name;
                    },
                  },
                  edgeSymbol: ["none", "arrow"],
                  edgeSymbolSize: [0, 8],
                  data: [
                    {
                      name: "预研阶段",
                      x: 10,
                      y: 50,
                      symbol: "rect",
                      itemStyle: {
                        color: "#8B5CF6",
                        borderColor: "#6D28D9",
                        borderWidth: 2,
                      },
                      symbolSize: [60, 35],
                    },
                    {
                      name: "正式申报",
                      x: 30,
                      y: 50,
                      symbol: "rect",
                      itemStyle: {
                        color: "#8B5CF6",
                        borderColor: "#6D28D9",
                        borderWidth: 2,
                      },
                      symbolSize: [60, 35],
                    },
                    {
                      name: "形式审查",
                      x: 50,
                      y: 50,
                      symbol: "diamond",
                      itemStyle: {
                        color: "#F59E0B",
                        borderColor: "#D97706",
                        borderWidth: 2,
                      },
                      symbolSize: [60, 45],
                    },
                    {
                      name: "专家评审",
                      x: 70,
                      y: 50,
                      symbol: "rect",
                      itemStyle: {
                        color: "#8B5CF6",
                        borderColor: "#6D28D9",
                        borderWidth: 2,
                      },
                      symbolSize: [60, 35],
                    },
                    {
                      name: "限期补正",
                      x: 50,
                      y: 20,
                      symbol: "rect",
                      itemStyle: {
                        color: "#EF4444",
                        borderColor: "#DC2626",
                        borderWidth: 2,
                      },
                      symbolSize: [60, 35],
                    },
                    {
                      name: "技术评审",
                      x: 90,
                      y: 50,
                      symbol: "diamond",
                      itemStyle: {
                        color: "#F59E0B",
                        borderColor: "#D97706",
                        borderWidth: 2,
                      },
                      symbolSize: [60, 45],
                    },
                    {
                      name: "公示征求意见",
                      x: 110,
                      y: 50,
                      symbol: "rect",
                      itemStyle: {
                        color: "#8B5CF6",
                        borderColor: "#6D28D9",
                        borderWidth: 2,
                      },
                      symbolSize: [70, 35],
                    },
                    {
                      name: "终止流程",
                      x: 90,
                      y: 80,
                      symbol: "rect",
                      itemStyle: {
                        color: "#EF4444",
                        borderColor: "#DC2626",
                        borderWidth: 2,
                      },
                      symbolSize: [60, 35],
                    },
                    {
                      name: "部际联席会议",
                      x: 130,
                      y: 50,
                      symbol: "rect",
                      itemStyle: {
                        color: "#8B5CF6",
                        borderColor: "#6D28D9",
                        borderWidth: 2,
                      },
                      symbolSize: [75, 35],
                    },
                    {
                      name: "国务院审批",
                      x: 150,
                      y: 50,
                      symbol: "rect",
                      itemStyle: {
                        color: "#10B981",
                        borderColor: "#059669",
                        borderWidth: 2,
                      },
                      symbolSize: [60, 35],
                    },
                    {
                      name: "发布实施",
                      x: 170,
                      y: 50,
                      symbol: "rect",
                      itemStyle: {
                        color: "#10B981",
                        borderColor: "#059669",
                        borderWidth: 2,
                      },
                      symbolSize: [60, 35],
                    },
                  ],
                  links: [
                    {
                      source: "预研阶段",
                      target: "正式申报",
                      lineStyle: { color: "#10B981", width: 2 },
                    },
                    {
                      source: "正式申报",
                      target: "形式审查",
                      lineStyle: { color: "#10B981", width: 2 },
                    },
                    {
                      source: "形式审查",
                      target: "专家评审",
                      label: {
                        show: true,
                        formatter: "通过",
                        color: "#059669",
                        fontSize: 9,
                        fontWeight: "bold",
                      },
                      lineStyle: { color: "#10B981", width: 2 },
                    },
                    {
                      source: "形式审查",
                      target: "限期补正",
                      label: {
                        show: true,
                        formatter: "不通过",
                        color: "#DC2626",
                        fontSize: 9,
                        fontWeight: "bold",
                      },
                      lineStyle: { color: "#EF4444", width: 2, type: "dashed" },
                    },
                    {
                      source: "限期补正",
                      target: "形式审查",
                      lineStyle: { color: "#F59E0B", width: 1, curveness: 0.3 },
                    },
                    {
                      source: "专家评审",
                      target: "技术评审",
                      lineStyle: { color: "#10B981", width: 2 },
                    },
                    {
                      source: "技术评审",
                      target: "公示征求意见",
                      label: {
                        show: true,
                        formatter: "通过",
                        color: "#059669",
                        fontSize: 9,
                        fontWeight: "bold",
                      },
                      lineStyle: { color: "#10B981", width: 2 },
                    },
                    {
                      source: "技术评审",
                      target: "终止流程",
                      label: {
                        show: true,
                        formatter: "不通过",
                        color: "#DC2626",
                        fontSize: 9,
                        fontWeight: "bold",
                      },
                      lineStyle: { color: "#EF4444", width: 2, type: "dashed" },
                    },
                    {
                      source: "公示征求意见",
                      target: "部际联席会议",
                      lineStyle: { color: "#10B981", width: 2 },
                    },
                    {
                      source: "部际联席会议",
                      target: "国务院审批",
                      lineStyle: { color: "#10B981", width: 2 },
                    },
                    {
                      source: "国务院审批",
                      target: "发布实施",
                      lineStyle: { color: "#10B981", width: 2 },
                    },
                  ],
                  lineStyle: {
                    opacity: 0.8,
                    width: 2,
                    curveness: 0.1,
                    color: "#4B5563",
                  },
                },
              ],
            });

            const wordCloudElement = section.querySelector(
              ".professions-word-cloud"
            );
            if (!wordCloudElement) {
              console.error("Word cloud element not found");
              return;
            }
            const wordCloudChart = echarts.init(wordCloudElement, "dark");
            // 存储为全局变量以供模态框使用
            window.wordCloudChart = wordCloudChart;
            wordCloudChart.setOption({
              tooltip: {
                ...echartsTooltipOption,
                formatter: (p) => `${p.name}: ${p.value}个岗位`,
              },
              series: [
                {
                  type: "wordCloud",
                  shape: "circle",
                  sizeRange: [15, 60],
                  rotationRange: [-30, 30],
                  textStyle: {
                    fontFamily: "sans-serif",
                    color: (params) =>
                      params.data.certified ? "#EF4444" : "#6B7280",
                  },
                  emphasis: {
                    textStyle: { fontWeight: "bold", color: "#fff" },
                  },
                  data: [
                    { name: "民宿管家", value: 1500, certified: true },
                    { name: "无人机驾驶员", value: 1200, certified: true },
                    { name: "老年数字服务师", value: 900, certified: true },
                    { name: "AI训练师", value: 1800, certified: true },
                    { name: "元宇宙场景策划师", value: 2500, certified: false },
                    { name: "宠物殡葬师", value: 800, certified: false },
                    { name: "数据标注员", value: 2200, certified: false },
                    { name: "游戏陪练师", value: 1600, certified: false },
                  ],
                },
              ],
            });

            const domainBarElement = section.querySelector(".domain-barchart");
            if (!domainBarElement) {
              console.error("Domain bar chart element not found");
              return;
            }
            const domainBarChart = echarts.init(domainBarElement, "dark");
            // 存储为全局变量以供模态框使用
            window.domainBarChart = domainBarChart;
            domainBarChart.setOption({
              tooltip: { ...echartsTooltipOption },
              grid: {
                left: "3%",
                right: "4%",
                bottom: "3%",
                containLabel: true,
              },
              xAxis: { type: "value" },
              yAxis: {
                type: "category",
                data: [
                  "信息技术",
                  "生活服务",
                  "文化娱乐",
                  "医疗健康",
                  "教育培训",
                ],
              },
              series: [
                {
                  name: "岗位数量",
                  type: "bar",
                  data: [18000, 15000, 12000, 9000, 7500],
                  itemStyle: {
                    color: new echarts.graphic.LinearGradient(1, 0, 0, 0, [
                      { offset: 0, color: "#3B82F6" },
                      { offset: 1, color: "#22D3EE" },
                    ]),
                  },
                  label: { show: true, position: "right", color: "#fff" },
                },
              ],
            });
          }, 100);
        }

        function setupSankeyChart(section) {
          setTimeout(() => {
            const sankeyElement = section.querySelector(".sankey-chart");
            if (!sankeyElement) {
              console.error("Sankey chart element not found");
              return;
            }
            const sankeyChart = echarts.init(sankeyElement, "dark");
            // 存储为全局变量以供模态框使用
            window.sankeyChart = sankeyChart;
            sankeyChart.setOption({
              tooltip: {
                trigger: "item",
                triggerOn: "mousemove",
                ...echartsTooltipOption,
              },
              series: {
                type: "sankey",
                emphasis: { focus: "adjacency" },
                nodeAlign: "left",
                data: [
                  { name: "技术突破", itemStyle: { color: "#3B82F6" } },
                  { name: "市场需求", itemStyle: { color: "#F97316" } },
                  { name: "政策引导", itemStyle: { color: "#10B981" } },
                  { name: "AI训练师" },
                  { name: "无人机驾驶员" },
                  { name: "民宿管家" },
                  { name: "老年数字服务师" },
                  { name: "剧本杀DM" },
                ],
                links: [
                  { source: "技术突破", target: "AI训练师", value: 10 },
                  { source: "技术突破", target: "无人机驾驶员", value: 8 },
                  { source: "市场需求", target: "民宿管家", value: 9 },
                  { source: "市场需求", target: "剧本杀DM", value: 7 },
                  { source: "政策引导", target: "老年数字服务师", value: 6 },
                  { source: "市场需求", target: "老年数字服务师", value: 4 },
                  { source: "技术突破", target: "民宿管家", value: 2 },
                ],
                lineStyle: { color: "source", curveness: 0.5 },
              },
            });
          }, 200);
        }

        function setupRectificationCharts(section) {
          setTimeout(() => {
            const rectificationElement = section.querySelector(
              ".rectification-word-clouds"
            );
            if (!rectificationElement) {
              console.error("Rectification chart element not found");
              return;
            }
            const rectificationChart = echarts.init(
              rectificationElement,
              "dark"
            );
            // 存储为全局变量以供模态框使用
            window.rectificationChart = rectificationChart;
            rectificationChart.setOption({
              grid: [
                { left: "5%", top: "5%", bottom: "5%", width: "40%" },
                { right: "5%", top: "5%", bottom: "5%", width: "40%" },
              ],
              xAxis: [
                { gridIndex: 0, show: false },
                { gridIndex: 1, show: false },
              ],
              yAxis: [
                { gridIndex: 0, show: false },
                { gridIndex: 1, show: false },
              ],
              graphic: [
                {
                  type: "text",
                  left: "25%",
                  top: "10%",
                  style: {
                    text: "2022年 (民间)",
                    fill: "#9CA3AF",
                    font: "bold 16px sans-serif",
                  },
                },
                {
                  type: "text",
                  right: "20%",
                  top: "10%",
                  style: {
                    text: "2024年 (官方)",
                    fill: "#9CA3AF",
                    font: "bold 16px sans-serif",
                  },
                },
                {
                  type: "text",
                  right: "18%",
                  bottom: "10%",
                  style: {
                    text: "规范化率提升 ↗",
                    fill: "#10B981",
                    font: "bold 18px sans-serif",
                  },
                },
              ],
              series: [
                {
                  type: "wordCloud",
                  xAxisIndex: 0,
                  yAxisIndex: 0,
                  sizeRange: [12, 35],
                  rotationRange: [-45, 45],
                  textStyle: { fontFamily: "KaiTi", color: "#6B7280" },
                  data: [
                    { name: "银发生活规划师", value: 10 },
                    { name: "老年陪伴师", value: 8 },
                    { name: "老年数字辅导员", value: 12 },
                    { name: "助老员", value: 6 },
                  ],
                },
                {
                  type: "wordCloud",
                  xAxisIndex: 1,
                  yAxisIndex: 1,
                  sizeRange: [20, 50],
                  rotationRange: [0, 0],
                  textStyle: {
                    fontFamily: "Microsoft YaHei",
                    color: "#EF4444",
                  },
                  data: [{ name: "老年数字服务师", value: 20 }],
                },
              ],
            });
          }, 300);
        }

        function setupRightsChart(section) {
          setTimeout(() => {
            const rightsElement = section.querySelector(".rights-barchart");
            if (!rightsElement) {
              console.error("Rights chart element not found");
              return;
            }
            const rightsChart = echarts.init(rightsElement, "dark");
            // 存储为全局变量以供模态框使用
            window.rightsChart = rightsChart;
            rightsChart.setOption({
              tooltip: {
                trigger: "axis",
                axisPointer: { type: "shadow" },
                ...echartsTooltipOption,
              },
              legend: {
                data: ["认证职业", "未认证职业"],
                textStyle: { color: "#fff" },
              },
              grid: {
                left: "3%",
                right: "4%",
                bottom: "3%",
                containLabel: true,
              },
              xAxis: {
                type: "category",
                data: ["工伤保险覆盖率", "职业培训覆盖率", "职称评定覆盖率"],
              },
              yAxis: { type: "value", axisLabel: { formatter: "{value} %" } },
              series: [
                {
                  name: "认证职业",
                  type: "bar",
                  itemStyle: { color: "#3B82F6" },
                  data: [85, 78, 65],
                },
                {
                  name: "未认证职业",
                  type: "bar",
                  itemStyle: { color: "#6B7280" },
                  data: [32, 25, 5],
                },
              ],
            });
          }, 400);
        }

        function setupReconstructionChart(section) {
          setTimeout(() => {
            const pieElement = section.querySelector(".factors-piechart");
            if (!pieElement) {
              console.error("Pie chart element not found");
              return;
            }
            const pieChart = echarts.init(pieElement, "dark");
            // 存储为全局变量以供模态框使用
            window.pieChart = pieChart;
            const stages = {
              2020: [
                { value: 65, name: "薪资待遇" },
                { value: 25, name: "情感认同" },
                { value: 10, name: "工作自由" },
              ],
              2025: [
                { value: 40, name: "薪资待遇" },
                { value: 30, name: "情感认同" },
                { value: 30, name: "工作自由" },
              ],
            };
            pieChart.setOption({
              title: {
                text: "职业选择核心因素演变",
                left: "center",
                textStyle: { color: "#fff" },
              },
              tooltip: {
                trigger: "item",
                formatter: "{a} <br/>{b}: {c}%",
                ...echartsTooltipOption,
              },
              legend: {
                orient: "vertical",
                left: 10,
                data: ["薪资待遇", "情感认同", "工作自由"],
                textStyle: { color: "#fff" },
              },
              series: [
                {
                  name: "2025年",
                  type: "pie",
                  radius: ["40%", "70%"],
                  avoidLabelOverlap: false,
                  label: { show: false, position: "center" },
                  emphasis: {
                    label: { show: true, fontSize: 20, fontWeight: "bold" },
                  },
                  labelLine: { show: false },
                  data: stages["2025"],
                },
              ],
            });
            pieElement.addEventListener("click", () => {
              const currentYear = pieChart
                .getOption()
                .series[0].name.includes("2025")
                ? "2020"
                : "2025";
              pieChart.setOption({
                series: [
                  { name: `${currentYear}年`, data: stages[currentYear] },
                ],
              });
            });
          }, 500);
        }

        function setupConclusionChart(section) {
          setTimeout(() => {
            const mapElement = section.querySelector(".future-map");
            if (!mapElement) {
              console.error("Map chart element not found");
              return;
            }
            const mapChart = echarts.init(mapElement, "dark");
            // 存储为全局变量以供模态框使用
            window.mapChart = mapChart;
            const professions = [
              { name: "AI训练师", value: 1, category: 0 },
              { name: "无人机驾驶员", value: 1, category: 0 },
              { name: "元宇宙策划师", value: 1, category: 1 },
              { name: "游戏陪练师", value: 1, category: 1 },
              { name: "汉服造型师", value: 1, category: 1 },
              { name: "整理收纳师", value: 1, category: 1 },
            ];
            mapChart.setOption({
              title: {
                text: "中国新职业图谱",
                left: "center",
                textStyle: { color: "#fff" },
              },
              tooltip: {},
              legend: [
                {
                  data: ["已认证", "未认证"],
                  top: "bottom",
                  textStyle: { color: "#fff" },
                },
              ],
              animationDurationUpdate: 1500,
              animationEasingUpdate: "quinticInOut",
              series: [
                {
                  type: "graph",
                  layout: "force",
                  force: { repulsion: 80 },
                  data: professions,
                  categories: [
                    { name: "已认证", itemStyle: { color: "#EF4444" } },
                    { name: "未认证", itemStyle: { color: "#6B7280" } },
                  ],
                  roam: true,
                  label: { show: true, formatter: "{b}" },
                  lineStyle: { color: "source", curveness: 0.3 },
                },
              ],
            });
          }, 600);
        }

        // --- 启动页面 ---
        initPage();

        // 优化窗口尺寸变化时的响应式处理
        const resizeObserver = new ResizeObserver(
          throttle(() => {
            // 收集所有已初始化的图表实例并重新渲染
            const charts = document.querySelectorAll("[_echarts_instance_]");
            charts.forEach((element) => {
              const chart = echarts.getInstanceByDom(element);
              if (chart && !chart.isDisposed()) {
                chart.resize();
              }
            });
          }, 300)
        );

        // 监听所有图表容器的尺寸变化
        document.addEventListener('DOMContentLoaded', () => {
          const chartContainers = document.querySelectorAll('.chart-container');
          chartContainers.forEach(container => {
            resizeObserver.observe(container);
          });
        });

        // 页面卸载时清理资源
        window.addEventListener('beforeunload', () => {
          // 清理所有图表实例
          const charts = document.querySelectorAll("[_echarts_instance_]");
          charts.forEach((element) => {
            const chart = echarts.getInstanceByDom(element);
            if (chart && !chart.isDisposed()) {
              chart.dispose();
            }
            
            // 清理事件监听器
            if (element._resizeHandler) {
              window.removeEventListener("resize", element._resizeHandler);
            }
          });
          
          // 清理 ResizeObserver
          resizeObserver.disconnect();
        });
      });

      // 滚动到顶部功能
      function scrollToTop() {
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      }

      // 导航高亮和进度指示器功能
      function updateNavigation() {
        const sections = ['header', 'status-intro', 'status', 'drivers', 'rectification', 'predicament', 'reconstruction', 'conclusion'];
        const navLinks = document.querySelectorAll('.nav-section');
        const progressBar = document.getElementById('navProgress');
        
        let currentSection = 'header';
        let maxScroll = 0;
        
        // 找到当前可见的section
        sections.forEach((sectionId, index) => {
          const element = document.getElementById(sectionId);
          if (element) {
            const rect = element.getBoundingClientRect();
            const elementTop = rect.top;
            const elementHeight = rect.height;
            
            // 如果section的顶部在视口上半部分，或者是最后一个可见的section
            if (elementTop <= window.innerHeight * 0.3) {
              currentSection = sectionId;
              maxScroll = Math.max(maxScroll, index);
            }
          }
        });
        
        // 更新导航链接高亮
        navLinks.forEach(link => {
          const section = link.getAttribute('data-section');
          if (section === currentSection) {
            link.classList.add('nav-active');
          } else {
            link.classList.remove('nav-active');
          }
        });
        
        // 更新进度条
        if (progressBar) {
          const progress = Math.min(100, (maxScroll / (sections.length - 1)) * 100);
          progressBar.style.height = `${progress}%`;
        }
      }

      // 监听滚动事件
      let scrollTimeout;
      window.addEventListener('scroll', () => {
        clearTimeout(scrollTimeout);
        scrollTimeout = setTimeout(updateNavigation, 100);
      });

      // 页面加载完成后初始化导航
      document.addEventListener('DOMContentLoaded', () => {
        updateNavigation();
      });

      // 优化的图片放大功能
      function openImageModal(img) {
        console.log('openImageModal called with:', img);
        const modal = document.getElementById('imageModal');
        const modalImg = document.getElementById('modalImage');
        
        console.log('modal:', modal, 'modalImg:', modalImg);
        
        if (modal && modalImg) {
          modalImg.src = img.src;
          modalImg.alt = img.alt;
          modal.classList.add('show');
          
          // 检查类是否添加成功
          console.log('Classes after adding show:', modal.className);
          console.log('Computed style display:', window.getComputedStyle(modal).display);
          
          // 防止背景滚动
          document.body.style.overflow = 'hidden';
          
          // 添加键盘事件监听
          document.addEventListener('keydown', handleKeyPress);
          
          console.log('Modal should be visible now');
        } else {
          console.error('Modal elements not found');
        }
      }

      function closeImageModal() {
        const modal = document.getElementById('imageModal');
        modal.classList.remove('show');
        
        // 恢复背景滚动
        document.body.style.overflow = 'auto';
        
        // 移除键盘事件监听
        document.removeEventListener('keydown', handleKeyPress);
      }

      // 图表放大功能
      let currentModalChart = null;
      let originalChartData = null;

      function openChartModal(chartInstance, chartElement) {
        const modal = document.getElementById('chartModal');
        const modalChartDiv = document.getElementById('modalChart');
        
        // 保存原始图表配置
        originalChartData = chartInstance.getOption();
        
        // 显示模态框
        modal.classList.add('show');
        document.body.style.overflow = 'hidden';
        
        // 创建新的图表实例
        setTimeout(() => {
          if (currentModalChart) {
            currentModalChart.dispose();
          }
          
          currentModalChart = echarts.init(modalChartDiv, 'dark');
          
          // 克隆并优化配置用于放大显示
          const modalOption = JSON.parse(JSON.stringify(originalChartData));
          
          // 针对不同图表类型进行优化
          if (modalOption.title && modalOption.title[0]) {
            modalOption.title[0].textStyle = {
              ...modalOption.title[0].textStyle,
              fontSize: 24
            };
          }
          
          // 优化文字大小
          if (modalOption.xAxis) {
            if (Array.isArray(modalOption.xAxis)) {
              modalOption.xAxis.forEach(axis => {
                if (axis.axisLabel) axis.axisLabel.fontSize = 14;
              });
            } else {
              if (modalOption.xAxis.axisLabel) modalOption.xAxis.axisLabel.fontSize = 14;
            }
          }
          
          if (modalOption.yAxis) {
            if (Array.isArray(modalOption.yAxis)) {
              modalOption.yAxis.forEach(axis => {
                if (axis.axisLabel) axis.axisLabel.fontSize = 14;
              });
            } else {
              if (modalOption.yAxis.axisLabel) modalOption.yAxis.axisLabel.fontSize = 14;
            }
          }
          
          // 优化图例
          if (modalOption.legend) {
            modalOption.legend.textStyle = {
              ...modalOption.legend.textStyle,
              fontSize: 14
            };
          }
          
          // 设置配置并渲染
          currentModalChart.setOption(modalOption);
          
          // 监听窗口大小变化
          const resizeObserver = new ResizeObserver(() => {
            if (currentModalChart) {
              currentModalChart.resize();
            }
          });
          resizeObserver.observe(modalChartDiv);
          
          // 保存observer以便清理
          currentModalChart._resizeObserver = resizeObserver;
        }, 100);
        
        // 添加键盘事件监听
        document.addEventListener('keydown', handleChartKeyPress);
      }

      function closeChartModal() {
        const modal = document.getElementById('chartModal');
        modal.classList.remove('show');
        document.body.style.overflow = 'auto';
        
        // 清理图表实例和observer
        if (currentModalChart) {
          if (currentModalChart._resizeObserver) {
            currentModalChart._resizeObserver.disconnect();
          }
          currentModalChart.dispose();
          currentModalChart = null;
        }
        
        originalChartData = null;
        
        // 移除键盘事件监听
        document.removeEventListener('keydown', handleChartKeyPress);
      }

      // 图表键盘事件处理
      function handleChartKeyPress(event) {
        if (event.key === 'Escape') {
          closeChartModal();
        }
      }

      // 为图表容器添加点击事件监听器
      function addChartClickListeners() {
        // 等待所有图表初始化完成后添加监听器
        setTimeout(() => {
          const chartContainers = [
            { selector: '#header-chart', chart: 'headerChart' },
            { selector: '.lifecycle-chart', chart: 'lifecycleChart' },
            { selector: '.professions-word-cloud', chart: 'wordCloudChart' },
            { selector: '.domain-barchart', chart: 'domainBarChart' },
            { selector: '.sankey-chart', chart: 'sankeyChart' },
            { selector: '.rectification-word-clouds', chart: 'rectificationChart' },
            { selector: '.rights-barchart', chart: 'rightsChart' },
            { selector: '.factors-piechart', chart: 'pieChart' },
            { selector: '.future-map', chart: 'mapChart' }
          ];
          
          chartContainers.forEach(({ selector, chart }) => {
            const element = document.querySelector(selector);
            if (element && window[chart]) {
              element.addEventListener('click', (e) => {
                e.stopPropagation();
                openChartModal(window[chart], element);
              });
            }
          });
        }, 3000); // 给足够的时间让所有图表加载完成
      }

      // 键盘事件处理
      function handleKeyPress(event) {
        if (event.key === 'Escape') {
          closeImageModal();
        }
      }

      // 优化模态框点击事件，只在点击背景时关闭
      document.addEventListener('DOMContentLoaded', function() {
        const modal = document.getElementById('imageModal');
        const modalImg = document.getElementById('modalImage');
        
        if (modal && modalImg) {
          modal.addEventListener('click', function(event) {
            // 只有点击背景（非图片）时才关闭模态框
            if (event.target === modal) {
              closeImageModal();
            }
          });
          
          // 阻止点击图片时的事件冒泡
          modalImg.addEventListener('click', function(event) {
            event.stopPropagation();
          });
        }
        
        // 添加图表点击监听器
        addChartClickListeners();
      });
    </script>
  </body>
</html>
